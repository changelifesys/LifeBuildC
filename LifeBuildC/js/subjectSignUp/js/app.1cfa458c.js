(function(e){function t(t){for(var s,i,r=t[0],c=t[1],l=t[2],f=0,g=[];f<r.length;f++)i=r[f],o[i]&&g.push(o[i][0]),o[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(g.length)g.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(s=!1)}s&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},o={1:0},a=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;a.push([3,0]),n()})({"0Ymv":function(e,t,n){e.exports=n.p+"img/title.eb480c91.jpg"},"2fKa":function(e,t,n){},3:function(e,t,n){e.exports=n("Vtdi")},Vtdi:function(e,t,n){"use strict";n.r(t);n("VRzm");var s=n("Kw5r"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.pageLoading,expression:"pageLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"app"}},[s("section",[s("header",{staticClass:"alignCenter"},[s("img",{attrs:{src:n("0Ymv"),id:"main-img"}}),s("h1",[e._v("生命建造程序")]),s("h3",[e._v(e._s(e.className))])]),e.className&&"form"===e.showBlock?s("registration-form",{attrs:{subInfo:e.subInfo,groupData:e.groupData},on:{onSignSuccess:function(t){e.onSignSuccess(t)}}}):e._e(),e.signData&&"signInfo"===e.showBlock?s("sign-info",{attrs:{signData:e.signData},on:{reSignUp:function(t){e.reSignUp(t)}}}):e._e()],1)])},a=[],i=(n("KKXr"),n("OG14"),n("vDqi")),r=n.n(i),c=n("cr+I"),l=n.n(c),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-main",[n("el-col",{attrs:{span:12,offset:6,xs:{span:19,offset:3}}},[n("div",{staticClass:"class-info"},[n("el-alert",{attrs:{type:"info",title:"",description:"本表個人資料將作建檔處理，並於日後會務活動運作之目的內，由教會及同工作為聯絡通訊、關懷及相關合理運用。我們會盡善良管理人責任，妥善保管資料，避免外洩或不當用途之使用。",closable:!1}}),n("ul",{staticClass:"class-detail"},[n("li",[n("div",{staticClass:"class-detail-title"},[e._v("報名條件：")]),n("div",{staticClass:"class-detail-text"},[e._v(e._s(e.subInfo.condition))])]),n("li",[n("div",{staticClass:"class-detail-title"},[e._v("上課日期：")]),n("div",{staticClass:"class-detail-text"},[e._v(e._s(e.subInfo.date))])]),n("li",[n("div",{staticClass:"class-detail-title"},[e._v("地點：")]),n("div",{staticClass:"class-detail-text"},[e._v(e._s(e.subInfo.location))])]),n("li",[n("div",{staticClass:"class-detail-title"},[e._v("報名日期：")]),n("div",{staticClass:"class-detail-text"},[e._v(e._s(e.subInfo.endDate))])])])],1),n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":e.labelPosition,"label-width":"105px"},nativeOn:{submit:function(t){return t.preventDefault(),e.checkEnter(t)}}},[n("el-form-item",{attrs:{label:"組別",prop:"gcroup"}},[n("el-select",{on:{change:e.onGcroupChange},model:{value:e.form.gcroup,callback:function(t){e.$set(e.form,"gcroup",t)},expression:"form.gcroup"}},e._l(e.groupData,function(t){return n("el-option",{key:t.group,attrs:{value:t.group}},[e._v(e._s(t.group))])}))],1),n("el-form-item",{attrs:{label:"小組",prop:"group"}},[n("el-select",{model:{value:e.form.group,callback:function(t){e.$set(e.form,"group",t)},expression:"form.group"}},e._l(e.groupList,function(t){return n("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}))],1),n("el-form-item",{attrs:{label:"姓名",prop:"name"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"手機",prop:"phone"}},[n("el-input",{attrs:{type:"number"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),n("el-form-item",{attrs:{label:"",prop:"cacheInfo"}},[n("el-checkbox-group",{model:{value:e.form.cacheInfo,callback:function(t){e.$set(e.form,"cacheInfo",t)},expression:"form.cacheInfo"}},[n("el-checkbox",{attrs:{label:"記住我的資訊",name:"cacheInfo"}})],1)],1),n("el-form-item",[n("el-button",{attrs:{size:"small",type:"primary",loading:e.sending},on:{click:function(t){e.checkMember("form")}}},[e._v("報名")]),n("el-button",{attrs:{size:"small",disabled:e.sending},on:{click:function(t){e.resetForm("form")}}},[e._v("重置")])],1)],1)],1)],1)},f=[],g=(n("f3/d"),n("LvDl")),p="/api/",m="".concat(p,"GetSUBInfo.aspx"),d="".concat(p,"GetGroupItem.aspx"),h="".concat(p,"AddSubSign.aspx"),v="".concat(p,"ChkMember.aspx"),b={data:function(){return{labelPosition:"right",form:{gcroup:"",group:"",name:"",phone:"",cacheInfo:!0,mid:"",dataChangeMsg:[]},rules:{gcroup:[{required:!0,message:"請選擇組別",trigger:"change"}],group:[{required:!0,message:"請選擇小組",trigger:"change"}],name:[{required:!0,message:"請輸入名字",trigger:"blur"}],phone:[{required:!0,message:"請輸入手機",trigger:"blur"},{validator:function(e,t,n){var s=/^[09]{2}[0-9]{8}$/;s.test(t)?n():n(new Error("請輸入正確手機格式"))},trigger:"blur"}]},sending:!1}},props:{subInfo:{type:Object,required:!0},groupData:{type:Array,required:!0}},computed:{groupList:function(){var e=Object(g["find"])(this.groupData,{group:this.form.gcroup});return Object(g["get"])(e,"list",[])}},methods:{checkMember:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.sending=!0;var n=t.$createElement,s=t;r.a.post(v,{group:t.form.group,Ename:t.form.name,Phone:t.form.phone}).then(function(e){s.sending=!1;var t=e.data,o=t.IsChgShow,a=t.ApiTitle,i=t.DataChangeMsg,r=t.MID;if(o){var c=[];i.map(function(e){return c.push(n("li",null,e)),e}),s.$msgbox({title:a,message:n("ul",null,c),confirmButtonText:"我要更新資料＋報名",showCancelButton:!0,cancelButtonText:"重新填寫",beforeClose:function(e,t,n){"confirm"===e?(s.form.mid=r,s.form.dataChangeMsg=i,s.submitForm(),n()):(s.resetForm("form"),n())}})}else s.form.mid=r,s.form.dataChangeMsg=i,s.submitForm()}).catch(function(e){s.sending=!1,s.$message({message:"發送發生錯誤，請稍後再試",type:"error"})})})},submitForm:function(){var e=this;this.sending=!0,r.a.post(h,{DataChangeMsg:this.form.dataChangeMsg,MID:this.form.mid,SID:this.subInfo.sid,CategoryID:this.subInfo.categoryID,gcroup:this.form.gcroup,group:this.form.group,Ename:this.form.name,Phone:this.form.phone,Gmail:"",Church:""}).then(function(t){e.sending=!1;var n=t.data,s=n.IsApiError,o=n.ApiMsg;if(s)e.$message({message:o,type:"error"});else{if(e.form.cacheInfo){var a=new Date;a.setDate(a.getDate()+360),e.$cookie.set("clc-sign-gcroup",e.form.gcroup,{expires:a}),e.$cookie.set("clc-sign-group",e.form.group,{expires:a}),e.$cookie.set("clc-sign-name",e.form.name,{expires:a}),e.$cookie.set("clc-sign-phone",e.form.phone,{expires:a})}else e.$cookie.delete("clc-sign-gcroup"),e.$cookie.delete("clc-sign-group"),e.$cookie.delete("clc-sign-name"),e.$cookie.delete("clc-sign-phone");e.resetForm("form"),e.$emit("onSignSuccess",t.data)}}).catch(function(t){e.sending=!1,e.$message({message:"發送發生錯誤，請稍後再試",type:"error"})})},resetForm:function(e){this.$refs[e].resetFields()},onGcroupChange:function(){this.form.group=""},onResize:function(){this.labelPosition=window.innerWidth<=768?"top":"right"}},mounted:function(){window.addEventListener("resize",this.onResize),this.onResize(),this.form.gcroup=this.$cookie.get("clc-sign-gcroup")||"",this.form.group=this.$cookie.get("clc-sign-group")||"",this.form.name=this.$cookie.get("clc-sign-name")||"",this.form.phone=this.$cookie.get("clc-sign-phone")||""},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)}},_=b,I=(n("rfga"),n("KHd+")),C=Object(I["a"])(_,u,f,!1,null,null,null),D=C.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-main",[n("el-col",{attrs:{span:12,offset:6,xs:{span:19,offset:3}}},[n("div",{staticClass:"class-info alignCenter"},[n("h2",{staticClass:"status-success"},[n("i",{staticClass:"el-icon-success"}),e._v(" "+e._s(e.signData.ApiMsg))]),n("ul",{staticClass:"class-detail inlineBlock alignLeft"},[n("li",[n("span",{staticClass:"class-detail-title"},[e._v("組別：")]),n("span",{staticClass:"class-detail-text"},[e._v(e._s(e.signData.gcroup))])]),n("li",[n("span",{staticClass:"class-detail-title"},[e._v("小組：")]),n("span",{staticClass:"class-detail-text"},[e._v(e._s(e.signData.group))])]),n("li",[n("span",{staticClass:"class-detail-title"},[e._v("姓名：")]),n("span",{staticClass:"class-detail-text"},[e._v(e._s(e.signData.Ename))])]),n("li",[n("span",{staticClass:"class-detail-title"},[e._v("手機：")]),n("span",{staticClass:"class-detail-text"},[e._v(e._s(e.signData.Phone))])])]),n("br"),n("br"),n("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:function(t){e.$emit("reSignUp")}}},[e._v("重新報名")]),n("br"),n("br")],1)])],1)},k=[],w={props:{signData:{type:Object,required:!0}}},$=w,y=Object(I["a"])($,x,k,!1,null,null,null),S=y.exports,L={name:"app",data:function(){return{showBlock:"form",className:"",subInfo:{condition:"",date:"",endDate:"",location:"",name:"",categoryID:""},signData:null,groupData:[],getSubInfoLoading:!0,getGroupItemLoading:!0}},components:{registrationForm:D,signInfo:S},computed:{pageLoading:function(){return this.getSubInfoLoading||this.getGroupItemLoading}},methods:{showWarning:function(e){this.$alert(e,{type:"error",showClose:!1,showConfirmButton:!1,center:!0})},onSignSuccess:function(e){this.signData=e,this.showBlock="signInfo"},reSignUp:function(){this.signData=null,this.showBlock="form"}},created:function(){var e=this,t=l.a.parse(window.location.search),n=t.id;n?(r.a.post(m,{CategoryID:n.toUpperCase()}).then(function(t){var n=t.data,s=n.SUCondition,o=n.SubDate,a=n.SubEndDate,i=n.SubLocation,r=n.IsApiError,c=n.ApiMsg,l=n.SubName,u=n.CategoryID,f=n.SID;r?e.showWarning(c):(e.className=l.split("生命建造程序 ")[1],e.subInfo.condition=s,e.subInfo.date=o,e.subInfo.endDate=a,e.subInfo.location=i,e.subInfo.categoryID=u,e.subInfo.sid=f,e.getSubInfoLoading=!1)}).catch(function(t){e.showWarning("很抱歉！我們的服務發生了問題")}),r.a.get(d).then(function(t){e.groupData=t.data.DataInfo,e.getGroupItemLoading=!1}).catch(function(t){e.showWarning("很抱歉！我們的服務發生了問題")})):this.showWarning("查無課程資訊")}},M=L,O=Object(I["a"])(M,o,a,!1,null,null,null),E=O.exports,j=n("XJYT"),B=n.n(j),F=n("AOfK"),q=n.n(F),z=n("yHtJ"),G=n.n(z);n("iqH7"),n("eKdF");s["default"].use(B.a,{locale:G.a}),s["default"].use(q.a),s["default"].config.productionTip=!1,new s["default"]({render:function(e){return e(E)}}).$mount("#app")},eKdF:function(e,t,n){},iqH7:function(e,t,n){},rfga:function(e,t,n){"use strict";var s=n("2fKa"),o=n.n(s);o.a}});
//# sourceMappingURL=app.1cfa458c.js.map